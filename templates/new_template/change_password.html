{% extends "new_template/base.html" %}
{% block title %}
    Cambiar contraseña
{% endblock title %}
{% block style %}
<style>
    .title{
        text-align: center;
    }
    form{
        margin: 0 auto;
    }
    .login{
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        color: white;
        position: relative;
        max-width: 100vw;
        padding-bottom: 20px;
        width: 500px;
        background: #002424;
      }
    input{
        margin: 10px 0 20px 0;
    }
    @media (min-width:480px) and (max-width:700px) {
        input{
          width: 40vw;
        }
        button, label{
          margin: 0
        }
      }

</style>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">

{% endblock style %}
{% block content %}
<a href="/" class="back">
    <img src="/static/images/back.svg" alt="volver">
    <span>Volver</span>
</a>

<form action="" class="card login" id="my_form">
    <h1 class="title">Cambiar contraseña</h1>
    <label for="password1">Ingresa tu nueva contraseña</label>
    <input class="styled" type="password" id="password1" name="password" placeholder="Ingresa una contraseña fuerte">
    <label for="password">Repite tu nueva contraseña</label>
    <input class="styled" type="password" id="password" name="verify_password" placeholder="Repite tu contraseña">
    <button type="button" id="save_btn" class="btn success">Guardar</button>
</form>
{% endblock content %}
{% block script %}
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

<script>
    function toast(text, color) {
        Toastify({
            text: text,
            duration: 5000,
            close: true,
            gravity: "top",
            position: "right",
            stopOnFocus: true,
            style: {
                background: color
            },
            onClick: function () {} // Callback after click
        }).showToast();
    }


    const save_btn = document.getElementById("save_btn"),
        my_form = document.getElementById("my_form");
    save_btn.addEventListener("click", async ()=>{
        const data = new FormData(my_form)
        const request = await fetch("/change_password",{
            method:"POST",
            body: data
        })
        const response = await request.json();
        if(response['response'] === "success"){
            toast(response['msg'], "#0e8843");
        }else{
            toast(response['msg'], "#9b0909");
        }

    })
</script>
{% endblock script %}